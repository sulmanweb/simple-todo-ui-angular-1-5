myApp.controller("mainCtrl",["$scope","$log","todoService",function(a,b,c){b.info("Loaded"),a.new_todo="",a.todos=[],a.edits=[],a.load_todos=function(){c.get_todos().success(function(c){a.todos=c,b.info("Get todos")}).error(function(a){b.error(a)})},a.load_todos(),a.check_new_todo=function(d){13===d.keyCode&&""!=a.new_todo&&(c.post_todo({name:a.new_todo}).success(function(c){b.info("posted!"),a.load_todos()}).error(function(a){b.error(a)}),a.new_todo="")},a.updateTodo=function(d,e){c.put_todo(d,e).success(function(c){b.info("updated!"),a.load_todos()}).error(function(a){b.error(a)})},a.update_todo_name=function(d,e){if(13===d.keyCode&&""!=e.name){var f=a.edits.indexOf(e.id);f>-1&&a.edits.splice(f,1),c.put_todo(e.id,e).success(function(c){b.info("updated!"),a.load_todos()}).error(function(a){b.error(a)})}},a.delete_todo=function(d){c.delete_todo(d).success(function(c){b.info("deleted!"),a.load_todos()}).error(function(a){b.error(a)})},a.addToEdits=function(b){0==b.done&&a.edits.push(b.id)}}]);