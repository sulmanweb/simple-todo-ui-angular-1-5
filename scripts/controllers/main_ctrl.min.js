myApp.controller("mainCtrl",["$scope","$log","todoService",function(o,t,d){t.info("Loaded"),o.new_todo="",o.todos=[],o.edits=[],o.load_todos=function(){d.get_todos().success(function(d){o.todos=d,t.info(o.todos)}).error(function(o){t.error(o)})},o.load_todos(),o.check_new_todo=function(e){13===e.keyCode&&""!=o.new_todo&&(d.post_todo({name:o.new_todo}).success(function(d){t.info("posted!"),o.load_todos()}).error(function(o){t.error(o)}),o.new_todo="",t.info(o.todos))},o.updateTodo=function(e,n){d.put_todo(e,n).success(function(d){t.info("updated!"),o.load_todos()}).error(function(o){t.error(o)})},o.update_todo_name=function(e,n){if(13===e.keyCode&&""!=n.name){var i=o.edits.indexOf(n.id);i>-1&&o.edits.splice(i,1),d.put_todo(n.id,n).success(function(d){t.info("updated!"),o.load_todos()}).error(function(o){t.error(o)})}},o.delete_todo=function(e){d.delete_todo(e).success(function(d){t.info("deleted!"),o.load_todos()}).error(function(o){t.error(o)})},o.addToEdits=function(t){0==t.done&&o.edits.push(t.id)}}]);